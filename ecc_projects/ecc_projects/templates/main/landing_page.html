{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="py-3 ">
        <!-- <div class="container-fluid  p-3 mb-2" style="background-color: #eee;">
            <div class="d-flex justify-content-end">
                
                <div class="mr-1">
                    <a class="btn btn-primary" href="#">Add task</a>
                </div>
                {% if permission %}
                <div class="mr-1">
                    <a class="btn btn-primary" href="#">Create Entrprise</a>
                </div>
                {%endif%}
            </div>

        </div> -->
        <div class="row d-flex justify-content-start">
            {%if tasks%}
            {%for task in tasks%}
            <div class="col-md-4">
                <div class="card shadow mb-3 " style="width: 24rem; border-left:2px solid #00FF00; height: 160px;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="card-title mt-1" style="color: #858585;">{{task.title}}</h5>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-outline-secondary"
                                    onclick="update_time_left({{task.id}})">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor"
                                        class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd"
                                            d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z">
                                        </path>
                                        <path
                                            d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z">
                                        </path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span style="color: #bdb8b8;">Owner :</span> {{task.owner.username}}
                            </div>
                            <div>
                                <span style="color: #bdb8b8;">Start time :</span> {{task.start_time}}
                            </div>
                        </div>
                        <div class="d-flex justify-content-between mt-2">
                            <div>
                                <span style="color: #bdb8b8;">Time left :</span> {{task.time_left}}
                            </div>
                        </div>
                        <div class="d-flex justify-content-end mt-2">
                            <div>
                                <a href="#" class="btn btn-sm btn-outline-primary">See details</a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>
            {%endfor%}
            {%endif%}

        </div>

    </div>

</div>
<script>
    function update_time_left(pk) {
        console.log(pk);
        console.log("task_in_page/%s/update" % pk);
        var data = {};
        $.ajax({
            url: "task_in_page/3/update",
            type: 'GET',
            data: data,
            dataType: 'json',
            success: function (resp) {
                $('#time_left').html(resp.html);
                console.log(resp);
                console.log(resp.html);
            }
        }).fail(function () {
            alert("error");
        })
            ;
    }

</script>

{% endblock content %}